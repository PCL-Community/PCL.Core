<Project Sdk="Microsoft.NET.Sdk">
    <!-- 项目属性 -->
    <PropertyGroup>
        <AssemblyTitle>PCL.Core</AssemblyTitle>
        <AssemblyName>PCL.Core</AssemblyName>
        <Description>PCL Community 为 PCL 开发的启动器核心库</Description>
        <Company>PCL Community</Company>
        <Product>PCL.Core</Product>
        <Copyright>Copyright © PCL Community</Copyright>
        <AssemblyVersion>1.0.0.0</AssemblyVersion>
        <FileVersion>1.0.0.0</FileVersion>
    </PropertyGroup>
    <PropertyGroup>
        <Configuration Condition="'$(Configuration)' == ''">Debug</Configuration>
        <Platform Condition="'$(Platform)' == ''">AnyCPU</Platform>
        <ProjectGuid>{A0C2209D-64FB-4C11-9459-8E86304B6F94}</ProjectGuid>
        <AppDesignerFolder>Properties</AppDesignerFolder>
        <RootNamespace>PCL.Core</RootNamespace>
        <TargetFrameworks>net481;net8.0-windows10.0.17763.0</TargetFrameworks>
        <LangVersion>13.0</LangVersion>
        <Nullable>enable</Nullable>
        <ErrorReport>prompt</ErrorReport>
        <WarningLevel>4</WarningLevel>
    </PropertyGroup>
    <PropertyGroup Condition="'$(TargetFramework)' == 'net8.0-windows10.0.17763.0'">
        <UseWPF>true</UseWPF>
    </PropertyGroup>
    <!-- 构建配置 -->
    <PropertyGroup Condition="'$(Configuration)' == 'Debug' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\Debug-$(Platform)\</OutputPath>
        <DefineConstants>DEBUG;TRACE</DefineConstants>
        <PlatformTarget>$(Platform)</PlatformTarget>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Configuration)' == 'Publish'">
        <DebugType>pdbonly</DebugType>
        <Optimize>true</Optimize>
        <OutputPath>bin\Publish-$(Platform)\</OutputPath>
        <DefineConstants>PUBLISH</DefineConstants>
        <PlatformTarget>$(Platform)</PlatformTarget>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Configuration)' == 'CI'">
        <DebugType>pdbonly</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\CI-$(Platform)\</OutputPath>
        <DefineConstants>CI;TRACE</DefineConstants>
        <PlatformTarget>$(Platform)</PlatformTarget>
    </PropertyGroup>
    <!-- 通用引用 -->
    <ItemGroup>
        <PackageReference Include="SharpZipLib" Version="1.4.2" />
        <PackageReference Include="System.Text.Json" Version="9.0.7" />
        <PackageReference Include="LiteDB" Version="5.0.21" />
        <PackageReference Include="System.Net.Http" Version="4.3.4" />
        <PackageReference Include="System.IO.Compression" Version="4.3.0" />
        <PackageReference Include="Microsoft.Toolkit.Uwp.Notifications" Version="7.1.3" />
    </ItemGroup>
    <!-- 分平台引用 -->
    <ItemGroup Condition="'$(TargetFramework)' == 'net481'">
        <Reference Include="Microsoft.CSharp" />
        <Reference Include="System.Management" />
        <Reference Include="PresentationFramework" />
        <Reference Include="PresentationCore" />
        <Reference Include="WindowsBase" />
        <PackageReference Include="PolySharp" Version="1.15.0">
            <PrivateAssets>all</PrivateAssets>
            <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
        </PackageReference>
    </ItemGroup>
    <ItemGroup Condition="'$(TargetFramework)' == 'net8.0-windows10.0.17763.0'">
        <PackageReference Include="Microsoft.CSharp" Version="4.7.0" />
        <PackageReference Include="System.Management" Version="8.0.0" />
    </ItemGroup>
    <!-- COM 引用 -->
    <ItemGroup>
        <COMReference Include="IWshRuntimeLibrary">
            <Guid>{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B}</Guid>
            <VersionMajor>1</VersionMajor>
            <VersionMinor>0</VersionMinor>
            <Lcid>0</Lcid>
            <WrapperTool>tlbimp</WrapperTool>
            <Isolated>false</Isolated>
            <EmbedInteropTypes>true</EmbedInteropTypes>
        </COMReference>
    </ItemGroup>
    <!-- 生成 LifecycleServiceTypes 类的自定义任务 -->
    <ItemGroup>
        <Compile Remove="App\LifecycleServiceTypes.g.cs" />
    </ItemGroup>
    <Target Name="GenerateLifecycleServiceTypes" BeforeTargets="CoreCompile">
        <Message Text="Generating LifecycleServiceTypes class..." Importance="normal" />
        <Exec Command="powershell.exe -ExecutionPolicy Bypass -File &quot;$(MSBuildProjectDirectory)\App\LifecycleServiceTypesGenerator.ps1&quot; &quot;$(MSBuildProjectDirectory)&quot;"
              ContinueOnError="false" />
        <ItemGroup>
            <Compile Include="App\LifecycleServiceTypes.g.cs" />
        </ItemGroup>
    </Target>
    <!-- 生成各种配置访问器的自定义任务 -->
    <ItemGroup>
        <Compile Remove="ProgramSetup\Setup.g.cs" />
        <Compile Remove="ProgramSetup\SetupEntries.g.cs" />
        <Compile Remove="ProgramSetup\SetupListenerRegisterer.g.cs" />
    </ItemGroup>
    <Target Name="GenerateSetupAccessor" BeforeTargets="CoreCompile">
        <Message Text="Generating setup accessors..." Importance="normal" />
        <Exec Command="powershell.exe -ExecutionPolicy Bypass -File &quot;$(MSBuildProjectDirectory)\ProgramSetup\SetupAccessorGenerator.ps1&quot; &quot;$(MSBuildProjectDirectory)&quot;"
              ContinueOnError="false" />
        <ItemGroup>
            <Compile Include="ProgramSetup\Setup.g.cs" />
            <Compile Include="ProgramSetup\SetupEntries.g.cs" />
            <Compile Include="ProgramSetup\SetupListenerRegisterer.g.cs" />
        </ItemGroup>
    </Target>
</Project>